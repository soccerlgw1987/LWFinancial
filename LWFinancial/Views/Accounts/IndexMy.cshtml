
@model LWFinancial.Models.Account
@using LWFinancial.Models
@using LWFinancial.Helpers
@using LWFinancial.Enumerations
@using Microsoft.AspNet.Identity

<section role="main" class="content-body">
    <header class="page-header">
        <h2>Add Accounts</h2>

        <div class="right-wrapper pull-right">
            <ol class="breadcrumbs">
                <li>
                    <a href="@Url.Action("Index","Households")">
                        <i class="fa fa-home"></i>
                    </a>
                </li>
                <li><span>Dashboard</span></li>
                <li><span>Accounts</span></li>
            </ol>

            <a class="sidebar-right-toggle" data-open="sidebar-right"><i class="fa fa-chevron-left"></i></a>
        </div>
    </header>

    <!-- start: page -->
    @{
        var db = new ApplicationDbContext();
        var user = db.Users.Find(User.Identity.GetUserId());
        var accountHelper = new AccountHelper();
        var householdHelper = new HouseholdsHelper();
    }

    <div class="row">
        <div class="col-md-6" style="padding-left:16px">
            <a class="mb-xs mt-xs mr-xs modal-with-move-anim btn btn-primary btn-lg" href="#accountModal">Create Account</a>
        </div>
    </div>
    <!--Create-->
    <div id="accountModal" class="zoom-anim-dialog modal-block modal-block-primary mfp-hide">
        <section class="panel">
            <header class="panel-heading">
                <h2 class="panel-title">Create an account</h2>
            </header>
            <div class="panel-body">
                @using (Html.BeginForm("Create", "Accounts", FormMethod.Post, new { @class = "form-horizontal mb-lg" }))
                {
                    @Html.AntiForgeryToken()
                    @Html.Hidden("householdId", user.HouseholdId)
                    @Html.HiddenFor(model => model.Created)
                    @Html.HiddenFor(model => model.CurrentBalance)
                    @Html.HiddenFor(model => model.ReconciledBalance)

                    <div class="form-group">
                        <label class="col-sm-3 control-label">Account Name</label>
                        <div class="col-sm-9">
                            @Html.Editor("Name", new { htmlAttributes = new { @class = "form-control", placeholder = "Type account name..." } })
                        </div>
                    </div>
                    <div class="form-group mt-lg">
                        <label class="col-sm-3 control-label">Initial Balance</label>
                        <div class="col-sm-9">
                            @Html.Editor("InitialBalance", new { htmlAttributes = new { @class = "form-control", placeholder = "Type the starting balance..." } })
                        </div>
                    </div>
                    <div class="form-group mt-lg">
                        <label class="col-sm-3 control-label">Low Balance Alert</label>
                        <div class="col-sm-9">
                            @Html.Editor("LowBalanceWarning", new { htmlAttributes = new { @class = "form-control", placeholder = "Type desired low alert amount..." } })
                        </div>
                    </div>
                    <br />
                    <footer class="panel-footer">
                        <div class="row">
                            <div class="col-md-12 text-right">
                                <input type="submit" value="Create" class="btn btn-primary" />
                                <input type="submit" value="Cancel" class="btn btn-default modal-dismiss" />
                            </div>
                        </div>
                    </footer>
                }
            </div>
        </section>
    </div>
    <!--Edit-->
    <!--Delete-->
    @Html.Partial("_AccountEdit", AccountEditHelper.GetAccountEditData(1))

    <!--Index-->
    @Html.Partial("_AccountTable", accountHelper.ListHouseholdAccounts(householdHelper.ListUserHousehold(User.Identity.GetUserId())))

    <!-- end: page -->

</section>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
